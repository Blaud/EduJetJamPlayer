var app=angular.module("flapperNews",["ui.router"]);app.factory("posts",["$http",function(){var t={posts:[{title:"Post #1",link:"/posts/1",upvotes:14,comments:[{author:"Joe",body:"Cool post!",upvotes:0},{author:"Bob",body:"Great idea but everything is wrong!",upvotes:0}]}]};return t.getAll=function(){return $http.get("/posts").success(function(o){angular.copy(o,t.posts)})},t.createNew=function(o){return $http.post("/posts",o).success(function(o){t.posts.push(o)})},t.upvote=function(t){return $http.put("/posts/"+t._id+"/upvote").success(function(o){t.upvotes+=1})},t.get=function(t){return $http.get("/posts/"+t).then(function(t){return t.data})},t.addComment=function(t,o){return $http.post("/posts/"+t+"/comments",o)},t.upvoteComment=function(t,o){return $http.put("/posts/"+t._id+"/comments/"+o._id+"/upvote").success(function(t){o.upvotes+=1})},t}]),app.config(["$stateProvider","$urlRouterProvider",function(t,o){t.state("home",{url:"/home",templateUrl:"/home.html",controller:"MainCtrl",resolve:{postPromise:["posts",function(t){return t.getAll()}]}}).state("posts",{url:"/posts/{id}",templateUrl:"/posts.html",controller:"PostsCtrl",resolve:{post:["$stateParams","posts",function(t,o){return o.get(t.id)}]}}),o.otherwise("home")}]),app.controller("PostsCtrl",["$scope","posts","$http","post",function(t,o,e){t.post=e,t.addComment=function(){""!==t.body&&(o.addComment(e._id,{body:t.body,author:"user"}).success(function(o){t.post.comments.push(o)}),t.body="")},t.incrementUpvotes=function(t){o.upvoteComment(e,t)}}]),app.controller("MainCtrl",["$scope","$http","posts",function(t,o){t.posts=o.posts,t.addPost=function(){t.title&&""!==t.title&&(o.createNew({title:t.title,link:t.link}),t.title="",t.link="")},t.incrementUpvotes=function(t){o.upvote(t)}}]);